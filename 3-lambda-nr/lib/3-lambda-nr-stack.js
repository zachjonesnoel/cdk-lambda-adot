"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.NRLambdaWorkshopStack = void 0;
const cdk = require("aws-cdk-lib");
const lambda = require("aws-cdk-lib/aws-lambda");
const apigatewayv2 = require("aws-cdk-lib/aws-apigatewayv2");
const apigatewayv2_integrations = require("aws-cdk-lib/aws-apigatewayv2-integrations");
const path = require("path");
class NRLambdaWorkshopStack extends cdk.Stack {
    constructor(scope, id, props) {
        super(scope, id, props);
        // Get context variables with defaults
        const environment = this.node.tryGetContext('environment') || 'development';
        const serviceName = this.node.tryGetContext('serviceName') || 'Node-Lambda-NR-Workshop';
        const nrLicenseKey = this.node.tryGetContext('nrLicenseKey') || 'MISSING_LICENSE_KEY';
        const nrAccountID = this.node.tryGetContext('nrAccountID') || 'MISSING_ACCOUNT_ID';
        const nrLayerArn = this.node.tryGetContext('adotLayerVersion') || 'arn:aws:lambda:us-east-1:451483290750:layer:NewRelicNodeJS22X:22';
        let NRLayer = lambda.LayerVersion.fromLayerVersionArn(this, 'NRLayer', nrLayerArn);
        // Create a simple Lambda function with API Gateway integration that returns a greeting message
        const greetingLambda = new lambda.Function(this, 'GreetingLambda', {
            runtime: lambda.Runtime.NODEJS_22_X,
            code: lambda.Code.fromAsset(path.join(__dirname, '../src/greeting-lambda')),
            handler: "newrelic-lambda-wrapper.handler",
            architecture: lambda.Architecture.X86_64,
            environment: {
                ENVIRONMENT: environment,
                SERVICE_NAME: serviceName,
                NEW_RELIC_ACCOUNT_ID: nrAccountID,
                NEW_RELIC_LAMBDA_HANDLER: 'greeting.handler',
                NEW_RELIC_LICENSE_KEY: nrLicenseKey,
                NEW_RELIC_EXTENSION_LOG_LEVEL: "DEBUG",
                NEW_RELIC_EXTENSION_SEND_EXTENSION_LOGS: "true",
                NEW_RELIC_EXTENSION_SEND_FUNCTION_LOGS: "true",
                NEW_RELIC_EXTENSION_LOGS_ENABLED: "true",
                NEW_RELIC_COLLECT_TRACE_ID: "true",
                NEW_RELIC_DISTRIBUTED_TRACING_ENABLED: "true",
            },
            description: `Greeting Lambda function for ${serviceName} in ${environment} environment`,
            tracing: lambda.Tracing.ACTIVE,
            memorySize: 256,
            timeout: cdk.Duration.seconds(5),
            layers: [NRLayer],
        });
        const greetinglambdaIntegration = new apigatewayv2_integrations.HttpLambdaIntegration('GreetingIntegration', greetingLambda);
        // Create an API Gateway HTTP API
        const greetingApi = new apigatewayv2.HttpApi(this, 'GreetingHandler', {
            apiName: `${serviceName}-GreetingAPI-${environment}`,
            description: `Greeting API Gateway for ${serviceName} in ${environment} environment`,
            defaultIntegration: greetinglambdaIntegration,
        });
        // Add a root path to the API
        greetingApi.addRoutes({
            path: '/',
            methods: [apigatewayv2.HttpMethod.GET],
            integration: greetinglambdaIntegration
        });
        // Output the API URL
        new cdk.CfnOutput(this, 'GreetingApiUrl', {
            value: greetingApi.apiEndpoint,
            description: 'Greeting API Gateway endpoint URL',
            exportName: `${id}-GreetingApiEndpoint`
        });
        // Output the environment
        new cdk.CfnOutput(this, 'GreetingEnvironment', {
            value: environment,
            description: 'Greeting Lambda deployment environment',
            exportName: `${id}-GreetingEnvironment`
        });
        // Output the service name
        new cdk.CfnOutput(this, 'GreetingServiceName', {
            value: serviceName,
            description: 'Greeting Lambda service name used for telemetry',
            exportName: `${id}-GreetingServiceName`
        });
        const HelloLambdaFunction = new lambda.Function(this, 'HelloLambdaFunction', {
            runtime: lambda.Runtime.NODEJS_18_X,
            code: lambda.Code.fromAsset(path.join(__dirname, '../src/invoker-lambda')),
            handler: "newrelic-lambda-wrapper.handler",
            architecture: lambda.Architecture.X86_64,
            environment: {
                ENVIRONMENT: environment,
                GREETING_API_ENDPOINT: greetingApi.apiEndpoint,
                NEW_RELIC_ACCOUNT_ID: nrAccountID,
                NEW_RELIC_LAMBDA_HANDLER: 'index.handler',
                NEW_RELIC_LICENSE_KEY: nrLicenseKey,
                NEW_RELIC_EXTENSION_LOG_LEVEL: "DEBUG",
                NEW_RELIC_EXTENSION_SEND_EXTENSION_LOGS: "true",
                NEW_RELIC_EXTENSION_SEND_FUNCTION_LOGS: "true",
                NEW_RELIC_EXTENSION_LOGS_ENABLED: "true",
                NEW_RELIC_COLLECT_TRACE_ID: "true",
                NEW_RELIC_DISTRIBUTED_TRACING_ENABLED: "true",
            },
            description: `Lambda function for ${serviceName} in ${environment} environment`,
            tracing: lambda.Tracing.ACTIVE,
            layers: [NRLayer],
            memorySize: 256,
            timeout: cdk.Duration.seconds(5),
        });
        // Create HTTP API Gateway
        const lambdaIntegration = new apigatewayv2_integrations.HttpLambdaIntegration('OtelAdotIntegration', HelloLambdaFunction);
        const httpApi = new apigatewayv2.HttpApi(this, 'OtelAdotHttpApi', {
            apiName: `${serviceName}-API-${environment}`,
            description: `HTTP API Gateway for ${serviceName} in ${environment} environment`,
            defaultIntegration: lambdaIntegration,
        });
        // Add root path
        httpApi.addRoutes({
            path: '/',
            methods: [apigatewayv2.HttpMethod.GET],
            integration: lambdaIntegration
        });
        // Output the API URL
        new cdk.CfnOutput(this, 'ApiUrl', {
            value: httpApi.apiEndpoint,
            description: 'HTTP API Gateway endpoint URL',
            exportName: `${id}-ApiEndpoint`
        });
        // Output the environment
        new cdk.CfnOutput(this, 'Environment', {
            value: environment,
            description: 'Deployment environment',
            exportName: `${id}-Environment`
        });
        // Output the service name
        new cdk.CfnOutput(this, 'ServiceName', {
            value: serviceName,
            description: 'Service name used for telemetry',
            exportName: `${id}-ServiceName`
        });
        // Add tags to the Lambda function
        cdk.Tags.of(HelloLambdaFunction).add('Environment', environment);
        cdk.Tags.of(HelloLambdaFunction).add('ServiceName', serviceName);
        cdk.Tags.of(HelloLambdaFunction).add('Project', 'OtelAdotNR-Workshop');
        cdk.Tags.of(HelloLambdaFunction).add('ManagedBy', 'CDK');
        cdk.Tags.of(HelloLambdaFunction).add('Workshop', 'AWS CDK ADOT Workshop');
        // Add tags to the API Gateway
        cdk.Tags.of(httpApi).add('Environment', environment);
        cdk.Tags.of(httpApi).add('ServiceName', serviceName);
        cdk.Tags.of(httpApi).add('Project', 'OtelAdotNR-Workshop');
        cdk.Tags.of(httpApi).add('ManagedBy', 'CDK');
        cdk.Tags.of(httpApi).add('Workshop', 'AWS CDK ADOT Workshop');
        // Add tags to the greeting Lambda function
        cdk.Tags.of(greetingLambda).add('Environment', environment);
        cdk.Tags.of(greetingLambda).add('ServiceName', serviceName);
        cdk.Tags.of(greetingLambda).add('Project', 'OtelAdotNR-Workshop');
        cdk.Tags.of(greetingLambda).add('ManagedBy', 'CDK');
        cdk.Tags.of(greetingLambda).add('Workshop', 'AWS CDK ADOT Workshop');
        // Add tags to the greeting API Gateway
        cdk.Tags.of(greetingApi).add('Environment', environment);
        cdk.Tags.of(greetingApi).add('ServiceName', serviceName);
        cdk.Tags.of(greetingApi).add('Project', 'OtelAdotNR-Workshop');
        cdk.Tags.of(greetingApi).add('ManagedBy', 'CDK');
        cdk.Tags.of(greetingApi).add('Workshop', 'AWS CDK ADOT Workshop');
        // Add tags to the stack
        cdk.Tags.of(this).add('Environment', environment);
        cdk.Tags.of(this).add('ServiceName', serviceName);
        cdk.Tags.of(this).add('Project', 'OtelAdotNR-Workshop');
        cdk.Tags.of(this).add('ManagedBy', 'CDK');
        cdk.Tags.of(this).add('Workshop', 'AWS CDK ADOT Workshop');
    }
}
exports.NRLambdaWorkshopStack = NRLambdaWorkshopStack;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMy1sYW1iZGEtbnItc3RhY2suanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIzLWxhbWJkYS1uci1zdGFjay50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSxtQ0FBbUM7QUFDbkMsaURBQWlEO0FBQ2pELDZEQUE2RDtBQUM3RCx1RkFBdUY7QUFFdkYsNkJBQTZCO0FBRTdCLE1BQWEscUJBQXNCLFNBQVEsR0FBRyxDQUFDLEtBQUs7SUFDbEQsWUFBWSxLQUFnQixFQUFFLEVBQVUsRUFBRSxLQUFzQjtRQUM5RCxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUV4QixzQ0FBc0M7UUFDdEMsTUFBTSxXQUFXLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDLElBQUksYUFBYSxDQUFDO1FBQzVFLE1BQU0sV0FBVyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxJQUFJLHlCQUF5QixDQUFDO1FBQ3hGLE1BQU0sWUFBWSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLGNBQWMsQ0FBQyxJQUFJLHFCQUFxQixDQUFDO1FBQ3RGLE1BQU0sV0FBVyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxJQUFJLG9CQUFvQixDQUFDO1FBQ25GLE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLGtCQUFrQixDQUFDLElBQUksa0VBQWtFLENBQUM7UUFFckksSUFBSSxPQUFPLEdBQUcsTUFBTSxDQUFDLFlBQVksQ0FBQyxtQkFBbUIsQ0FDakQsSUFBSSxFQUNKLFNBQVMsRUFDVCxVQUFVLENBQ1gsQ0FBQTtRQUNILCtGQUErRjtRQUMvRixNQUFNLGNBQWMsR0FBRyxJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLGdCQUFnQixFQUFFO1lBQ2pFLE9BQU8sRUFBRSxN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QUFHLENBQUMsVUFBVSxFQUFFLHVCQUF1QixDQUFDLENBQUM7UUFDckUsdUNBQXVDO1FBQ3ZDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLFdBQVcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxhQUFhLEVBQUUsV0FBVyxDQUFDLENBQUM7UUFDekQsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsV0FBVyxDQUFDLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxXQUFXLENBQUMsQ0FBQztRQUN6RCxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxXQUFXLENBQUMsQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLHFCQUFxQixDQUFDLENBQUM7UUFDL0QsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsV0FBVyxDQUFDLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUNqRCxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxXQUFXLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBVSxFQUFFLHVCQUF1QixDQUFDLENBQUM7UUFDbEUsd0JBQXdCO1FBQ3hCLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxhQUFhLEVBQUUsV0FBVyxDQUFDLENBQUM7UUFDbEQsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxXQUFXLENBQUMsQ0FBQztRQUNsRCxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLHFCQUFxQixDQUFDLENBQUM7UUFDeEQsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUMxQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBVSxFQUFFLHVCQUF1QixDQUFDLENBQUM7SUFFN0QsQ0FBQztDQUNGO0FBN0tELHNEQTZLQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGNkayBmcm9tICdhd3MtY2RrLWxpYic7XG5pbXBvcnQgKiBhcyBsYW1iZGEgZnJvbSAnYXdzLWNkay1saWIvYXdzLWxhbWJkYSc7XG5pbXBvcnQgKiBhcyBhcGlnYXRld2F5djIgZnJvbSAnYXdzLWNkay1saWIvYXdzLWFwaWdhdGV3YXl2Mic7XG5pbXBvcnQgKiBhcyBhcGlnYXRld2F5djJfaW50ZWdyYXRpb25zIGZyb20gJ2F3cy1jZGstbGliL2F3cy1hcGlnYXRld2F5djItaW50ZWdyYXRpb25zJztcbmltcG9ydCB7IENvbnN0cnVjdCB9IGZyb20gJ2NvbnN0cnVjdHMnO1xuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJztcblxuZXhwb3J0IGNsYXNzIE5STGFtYmRhV29ya3Nob3BTdGFjayBleHRlbmRzIGNkay5TdGFjayB7XG4gIGNvbnN0cnVjdG9yKHNjb3BlOiBDb25zdHJ1Y3QsIGlkOiBzdHJpbmcsIHByb3BzPzogY2RrLlN0YWNrUHJvcHMpIHtcbiAgICBzdXBlcihzY29wZSwgaWQsIHByb3BzKTtcblxuICAgIC8vIEdldCBjb250ZXh0IHZhcmlhYmxlcyB3aXRoIGRlZmF1bHRzXG4gICAgY29uc3QgZW52aXJvbm1lbnQgPSB0aGlzLm5vZGUudHJ5R2V0Q29udGV4dCgnZW52aXJvbm1lbnQnKSB8fCAnZGV2ZWxvcG1lbnQnO1xuICAgIGNvbnN0IHNlcnZpY2VOYW1lID0gdGhpcy5ub2RlLnRyeUdldENvbnRleHQoJ3NlcnZpY2VOYW1lJykgfHwgJ05vZGUtTGFtYmRhLU5SLVdvcmtzaG9wJztcbiAgICBjb25zdCBuckxpY2Vuc2VLZXkgPSB0aGlzLm5vZGUudHJ5R2V0Q29udGV4dCgnbnJMaWNlbnNlS2V5JykgfHwgJ01JU1NJTkdfTElDRU5TRV9LRVknO1xuICAgIGNvbnN0IG5yQWNjb3VudElEID0gdGhpcy5ub2RlLnRyeUdldENvbnRleHQoJ25yQWNjb3VudElEJykgfHwgJ01JU1NJTkdfQUNDT1VOVF9JRCc7XG4gICAgY29uc3QgbnJMYXllckFybiA9IHRoaXMubm9kZS50cnlHZXRDb250ZXh0KCdhZG90TGF5ZXJWZXJzaW9uJykgfHwgJ2Fybjphd3M6bGFtYmRhOnVzLWVhc3QtMTo0NTE0ODMyOTA3NTA6bGF5ZXI6TmV3UmVsaWNOb2RlSlMyMlg6MjInO1xuXG4gICAgbGV0IE5STGF5ZXIgPSBsYW1iZGEuTGF5ZXJWZXJzaW9uLmZyb21MYXllclZlcnNpb25Bcm4oXG4gICAgICAgIHRoaXMsXG4gICAgICAgICdOUkxheWVyJyxcbiAgICAgICAgbnJMYXllckFyblxuICAgICAgKVxuICAgIC8vIENyZWF0ZSBhIHNpbXBsZSBMYW1iZGEgZnVuY3Rpb24gd2l0aCBBUEkgR2F0ZXdheSBpbnRlZ3JhdGlvbiB0aGF0IHJldHVybnMgYSBncmVldGluZyBtZXNzYWdlXG4gICAgY29uc3QgZ3JlZXRpbmdMYW1iZGEgPSBuZXcgbGFtYmRhLkZ1bmN0aW9uKHRoaXMsICdHcmVldGluZ0xhbWJkYScsIHtcbiAgICAgIHJ1bnRpbWU6IGxhbWJkYS5SdW50aW1lLk5PREVKU18yMl9YLFxuICAgICAgY29kZTogbGFtYmRhLkNvZGUuZnJvbUFzc2V0KHBhdGguam9pbihfX2Rpcm5hbWUsICcuLi9zcmMvZ3JlZXRpbmctbGFtYmRhJykpLFxuICAgICAgaGFuZGxlcjogXCJuZXdyZWxpYy1sYW1iZGEtd3JhcHBlci5oYW5kbGVyXCIsXG4gICAgICBhcmNoaXRlY3R1cmU6IGxhbWJkYS5BcmNoaXRlY3R1cmUuWDg2XzY0LFxuICAgICAgZW52aXJvbm1lbnQ6IHtcbiAgICAgICAgRU5WSVJPTk1FTlQ6IGVudmlyb25tZW50LFxuICAgICAgICBTRVJWSUNFX05BTUU6IHNlcnZpY2VOYW1lLFxuICAgICAgICBORVdfUkVMSUNfQUNDT1VOVF9JRDogbnJBY2NvdW50SUQsXG4gICAgICAgIE5FV19SRUxJQ19MQU1CREFfSEFORExFUjogJ2dyZWV0aW5nLmhhbmRsZXInLFxuICAgICAgICBORVdfUkVMSUNfTElDRU5TRV9LRVk6IG5yTGljZW5zZUtleSxcbiAgICAgICAgTkVXX1JFTElDX0VYVEVOU0lPTl9MT0dfTEVWRUw6IFwiREVCVUdcIixcbiAgICAgICAgTkVXX1JFTElDX0VYVEVOU0lPTl9TRU5EX0VYVEVOU0lPTl9MT0dTOiBcInRydWVcIixcbiAgICAgICAgTkVXX1JFTElDX0VYVEVOU0lPTl9TRU5EX0ZVTkNUSU9OX0xPR1M6IFwidHJ1ZVwiLFxuICAgICAgICBORVdfUkVMSUNfRVhURU5TSU9OX0xPR1NfRU5BQkxFRDogXCJ0cnVlXCIsXG4gICAgICAgIE5FV19SRUxJQ19DT0xMRUNUX1RSQUNFX0lEOiBcInRydWVcIixcbiAgICAgICAgTkVXX1JFTElDX0RJU1RSSUJVVEVEX1RSQUNJTkdfRU5BQkxFRDogXCJ0cnVlXCIsXG4gICAgICB9LFxuICAgICAgZGVzY3JpcHRpb246IGBHcmVldGluZyBMYW1iZGEgZnVuY3Rpb24gZm9yICR7c2VydmljZU5hbWV9IGluICR7ZW52aXJvbm1lbnR9IGVudmlyb25tZW50YCxcbiAgICAgIHRyYWNpbmc6IGxhbWJkYS5UcmFjaW5nLkFDVElWRSxcbiAgICAgIG1lbW9yeVNpemU6IDEyOCxcbiAgICAgIHRpbWVvdXQ6IGNkay5EdXJhdGlvbi5zZWNvbmRzKDUpLFxuICAgICAgbGF5ZXJzOiBbTlJMYXllcl0sXG4gICAgfSk7XG5cbiAgICBjb25zdCBncmVldGluZ2xhbWJkYUludGVncmF0aW9uID0gbmV3IGFwaWdhdGV3YXl2Ml9pbnRlZ3JhdGlvbnMuSHR0cExhbWJkYUludGVncmF0aW9uKCdHcmVldGluZ0ludGVncmF0aW9uJywgZ3JlZXRpbmdMYW1iZGEpXG5cbiAgICAvLyBDcmVhdGUgYW4gQVBJIEdhdGV3YXkgSFRUUCBBUElcbiAgICBjb25zdCBncmVldGluZ0FwaSA9IG5ldyBhcGlnYXRld2F5djIuSHR0cEFwaSh0aGlzLCAnR3JlZXRpbmdIYW5kbGVyJywge1xuICAgICAgYXBpTmFtZTogYCR7c2VydmljZU5hbWV9LUdyZWV0aW5nQVBJLSR7ZW52aXJvbm1lbnR9YCxcbiAgICAgIGRlc2NyaXB0aW9uOiBgR3JlZXRpbmcgQVBJIEdhdGV3YXkgZm9yICR7c2VydmljZU5hbWV9IGluICR7ZW52aXJvbm1lbnR9IGVudmlyb25tZW50YCxcbiAgICAgIGRlZmF1bHRJbnRlZ3JhdGlvbjogZ3JlZXRpbmdsYW1iZGFJbnRlZ3JhdGlvbixcbiAgICB9KTtcblxuICAgIC8vIEFkZCBhIHJvb3QgcGF0aCB0byB0aGUgQVBJXG4gICAgZ3JlZXRpbmdBcGkuYWRkUm91dGVzKHtcbiAgICAgIHBhdGg6ICcvJyxcbiAgICAgIG1ldGhvZHM6IFthcGlnYXRld2F5djIuSHR0cE1ldGhvZC5HRVRdLFxuICAgICAgaW50ZWdyYXRpb246IGdyZWV0aW5nbGFtYmRhSW50ZWdyYXRpb25cbiAgICB9KTtcblxuICAgIC8vIE91dHB1dCB0aGUgQVBJIFVSTFxuICAgIG5ldyBjZGsuQ2ZuT3V0cHV0KHRoaXMsICdHcmVldGluZ0FwaVVybCcsIHtcbiAgICAgIHZhbHVlOiBncmVldGluZ0FwaS5hcGlFbmRwb2ludCxcbiAgICAgIGRlc2NyaXB0aW9uOiAnR3JlZXRpbmcgQVBJIEdhdGV3YXkgZW5kcG9pbnQgVVJMJyxcbiAgICAgIGV4cG9ydE5hbWU6IGAke2lkfS1HcmVldGluZ0FwaUVuZHBvaW50YFxuICAgIH0pO1xuICAgIC8vIE91dHB1dCB0aGUgZW52aXJvbm1lbnRcbiAgICBuZXcgY2RrLkNmbk91dHB1dCh0aGlzLCAnR3JlZXRpbmdFbnZpcm9ubWVudCcsIHtcbiAgICAgIHZhbHVlOiBlbnZpcm9ubWVudCxcbiAgICAgIGRlc2NyaXB0aW9uOiAnR3JlZXRpbmcgTGFtYmRhIGRlcGxveW1lbnQgZW52aXJvbm1lbnQnLFxuICAgICAgZXhwb3J0TmFtZTogYCR7aWR9LUdyZWV0aW5nRW52aXJvbm1lbnRgXG4gICAgfSk7XG4gICAgLy8gT3V0cHV0IHRoZSBzZXJ2aWNlIG5hbWVcbiAgICBuZXcgY2RrLkNmbk91dHB1dCh0aGlzLCAnR3JlZXRpbmdTZXJ2aWNlTmFtZScsIHtcbiAgICAgIHZhbHVlOiBzZXJ2aWNlTmFtZSxcbiAgICAgIGRlc2NyaXB0aW9uOiAnR3JlZXRpbmcgTGFtYmRhIHNlcnZpY2UgbmFtZSB1c2VkIGZvciB0ZWxlbWV0cnknLFxuICAgICAgZXhwb3J0TmFtZTogYCR7aWR9LUdyZWV0aW5nU2VydmljZU5hbWVgXG4gICAgfSk7XG5cbiAgICBjb25zdCBIZWxsb0xhbWJkYUZ1bmN0aW9uID0gbmV3IGxhbWJkYS5GdW5jdGlvbih0aGlzLCAnSGVsbG9MYW1iZGFGdW5jdGlvbicsIHtcbiAgICAgIHJ1bnRpbWU6IGxhbWJkYS5SdW50aW1lLk5PREVKU18xOF9YLFxuICAgICAgY29kZTogbGFtYmRhLkNvZGUuZnJvbUFzc2V0KHBhdGguam9pbihfX2Rpcm5hbWUsICcuLi9zcmMvaW52b2tlci1sYW1iZGEnKSksXG4gICAgICBoYW5kbGVyOiBcIm5ld3JlbGljLWxhbWJkYS13cmFwcGVyLmhhbmRsZXJcIixcbiAgICAgIGFyY2hpdGVjdHVyZTogbGFtYmRhLkFyY2hpdGVjdHVyZS5YODZfNjQsXG4gICAgICBlbnZpcm9ubWVudDoge1xuICAgICAgICBFTlZJUk9OTUVOVDogZW52aXJvbm1lbnQsXG4gICAgICAgIEdSRUVUSU5HX0FQSV9FTkRQT0lOVDogZ3JlZXRpbmdBcGkuYXBpRW5kcG9pbnQsXG4gICAgICAgIE5FV19SRUxJQ19BQ0NPVU5UX0lEOiBuckFjY291bnRJRCxcbiAgICAgICAgTkVXX1JFTElDX0xBTUJEQV9IQU5ETEVSOiAnaW5kZXguaGFuZGxlcicsXG4gICAgICAgIE5FV19SRUxJQ19MSUNFTlNFX0tFWTogbnJMaWNlbnNlS2V5LFxuICAgICAgICBORVdfUkVMSUNfRVhURU5TSU9OX0xPR19MRVZFTDogXCJERUJVR1wiLFxuICAgICAgICBORVdfUkVMSUNfRVhURU5TSU9OX1NFTkRfRVhURU5TSU9OX0xPR1M6IFwidHJ1ZVwiLFxuICAgICAgICBORVdfUkVMSUNfRVhURU5TSU9OX1NFTkRfRlVOQ1RJT05fTE9HUzogXCJ0cnVlXCIsXG4gICAgICAgIE5FV19SRUxJQ19FWFRFTlNJT05fTE9HU19FTkFCTEVEOiBcInRydWVcIixcbiAgICAgICAgTkVXX1JFTElDX0NPTExFQ1RfVFJBQ0VfSUQ6IFwidHJ1ZVwiLFxuICAgICAgICBORVdfUkVMSUNfRElTVFJJQlVURURfVFJBQ0lOR19FTkFCTEVEOiBcInRydWVcIixcbiAgICAgIH0sXG4gICAgICBkZXNjcmlwdGlvbjogYExhbWJkYSBmdW5jdGlvbiBmb3IgJHtzZXJ2aWNlTmFtZX0gaW4gJHtlbnZpcm9ubWVudH0gZW52aXJvbm1lbnRgLFxuICAgICAgdHJhY2luZzogbGFtYmRhLlRyYWNpbmcuQUNUSVZFLFxuICAgICAgbGF5ZXJzOiBbTlJMYXllcl0sXG4gICAgfSk7XG5cbiAgICAvLyBDcmVhdGUgSFRUUCBBUEkgR2F0ZXdheVxuICAgIGNvbnN0IGxhbWJkYUludGVncmF0aW9uID0gbmV3IGFwaWdhdGV3YXl2Ml9pbnRlZ3JhdGlvbnMuSHR0cExhbWJkYUludGVncmF0aW9uKFxuICAgICAgJ090ZWxBZG90SW50ZWdyYXRpb24nLFxuICAgICAgSGVsbG9MYW1iZGFGdW5jdGlvblxuICAgICk7XG5cbiAgICBjb25zdCBodHRwQXBpID0gbmV3IGFwaWdhdGV3YXl2Mi5IdHRwQXBpKHRoaXMsICdPdGVsQWRvdEh0dHBBcGknLCB7XG4gICAgICBhcGlOYW1lOiBgJHtzZXJ2aWNlTmFtZX0tQVBJLSR7ZW52aXJvbm1lbnR9YCxcbiAgICAgIGRlc2NyaXB0aW9uOiBgSFRUUCBBUEkgR2F0ZXdheSBmb3IgJHtzZXJ2aWNlTmFtZX0gaW4gJHtlbnZpcm9ubWVudH0gZW52aXJvbm1lbnRgLFxuICAgICAgZGVmYXVsdEludGVncmF0aW9uOiBsYW1iZGFJbnRlZ3JhdGlvbixcbiAgICB9KTtcblxuICAgIC8vIEFkZCByb290IHBhdGhcbiAgICBodHRwQXBpLmFkZFJvdXRlcyh7XG4gICAgICBwYXRoOiAnLycsXG4gICAgICBtZXRob2RzOiBbYXBpZ2F0ZXdheXYyLkh0dHBNZXRob2QuR0VUXSxcbiAgICAgIGludGVncmF0aW9uOiBsYW1iZGFJbnRlZ3JhdGlvblxuICAgIH0pO1xuXG4gICAgLy8gT3V0cHV0IHRoZSBBUEkgVVJMXG4gICAgbmV3IGNkay5DZm5PdXRwdXQodGhpcywgJ0FwaVVybCcsIHtcbiAgICAgIHZhbHVlOiBodHRwQXBpLmFwaUVuZHBvaW50LFxuICAgICAgZGVzY3JpcHRpb246ICdIVFRQIEFQSSBHYXRld2F5IGVuZHBvaW50IFVSTCcsXG4gICAgICBleHBvcnROYW1lOiBgJHtpZH0tQXBpRW5kcG9pbnRgXG4gICAgfSk7XG5cbiAgICAvLyBPdXRwdXQgdGhlIGVudmlyb25tZW50XG4gICAgbmV3IGNkay5DZm5PdXRwdXQodGhpcywgJ0Vudmlyb25tZW50Jywge1xuICAgICAgdmFsdWU6IGVudmlyb25tZW50LFxuICAgICAgZGVzY3JpcHRpb246ICdEZXBsb3ltZW50IGVudmlyb25tZW50JyxcbiAgICAgIGV4cG9ydE5hbWU6IGAke2lkfS1FbnZpcm9ubWVudGBcbiAgICB9KTtcblxuICAgIC8vIE91dHB1dCB0aGUgc2VydmljZSBuYW1lXG4gICAgbmV3IGNkay5DZm5PdXRwdXQodGhpcywgJ1NlcnZpY2VOYW1lJywge1xuICAgICAgdmFsdWU6IHNlcnZpY2VOYW1lLFxuICAgICAgZGVzY3JpcHRpb246ICdTZXJ2aWNlIG5hbWUgdXNlZCBmb3IgdGVsZW1ldHJ5JyxcbiAgICAgIGV4cG9ydE5hbWU6IGAke2lkfS1TZXJ2aWNlTmFtZWBcbiAgICB9KTtcblxuXG4gICAgLy8gQWRkIHRhZ3MgdG8gdGhlIExhbWJkYSBmdW5jdGlvblxuICAgIGNkay5UYWdzLm9mKEhlbGxvTGFtYmRhRnVuY3Rpb24pLmFkZCgnRW52aXJvbm1lbnQnLCBlbnZpcm9ubWVudCk7XG4gICAgY2RrLlRhZ3Mub2YoSGVsbG9MYW1iZGFGdW5jdGlvbikuYWRkKCdTZXJ2aWNlTmFtZScsIHNlcnZpY2VOYW1lKTtcbiAgICBjZGsuVGFncy5vZihIZWxsb0xhbWJkYUZ1bmN0aW9uKS5hZGQoJ1Byb2plY3QnLCAnT3RlbEFkb3ROUi1Xb3Jrc2hvcCcpO1xuICAgIGNkay5UYWdzLm9mKEhlbGxvTGFtYmRhRnVuY3Rpb24pLmFkZCgnTWFuYWdlZEJ5JywgJ0NESycpO1xuICAgIGNkay5UYWdzLm9mKEhlbGxvTGFtYmRhRnVuY3Rpb24pLmFkZCgnV29ya3Nob3AnLCAnQVdTIENESyBBRE9UIFdvcmtzaG9wJyk7XG4gICAgLy8gQWRkIHRhZ3MgdG8gdGhlIEFQSSBHYXRld2F5XG4gICAgY2RrLlRhZ3Mub2YoaHR0cEFwaSkuYWRkKCdFbnZpcm9ubWVudCcsIGVudmlyb25tZW50KTtcbiAgICBjZGsuVGFncy5vZihodHRwQXBpKS5hZGQoJ1NlcnZpY2VOYW1lJywgc2VydmljZU5hbWUpO1xuICAgIGNkay5UYWdzLm9mKGh0dHBBcGkpLmFkZCgnUHJvamVjdCcsICdPdGVsQWRvdE5SLVdvcmtzaG9wJyk7XG4gICAgY2RrLlRhZ3Mub2YoaHR0cEFwaSkuYWRkKCdNYW5hZ2VkQnknLCAnQ0RLJyk7XG4gICAgY2RrLlRhZ3Mub2YoaHR0cEFwaSkuYWRkKCdXb3Jrc2hvcCcsICdBV1MgQ0RLIEFET1QgV29ya3Nob3AnKTtcbiAgICAvLyBBZGQgdGFncyB0byB0aGUgZ3JlZXRpbmcgTGFtYmRhIGZ1bmN0aW9uXG4gICAgY2RrLlRhZ3Mub2YoZ3JlZXRpbmdMYW1iZGEpLmFkZCgnRW52aXJvbm1lbnQnLCBlbnZpcm9ubWVudCk7XG4gICAgY2RrLlRhZ3Mub2YoZ3JlZXRpbmdMYW1iZGEpLmFkZCgnU2VydmljZU5hbWUnLCBzZXJ2aWNlTmFtZSk7XG4gICAgY2RrLlRhZ3Mub2YoZ3JlZXRpbmdMYW1iZGEpLmFkZCgnUHJvamVjdCcsICdPdGVsQWRvdE5SLVdvcmtzaG9wJyk7XG4gICAgY2RrLlRhZ3Mub2YoZ3JlZXRpbmdMYW1iZGEpLmFkZCgnTWFuYWdlZEJ5JywgJ0NESycpO1xuICAgIGNkay5UYWdzLm9mKGdyZWV0aW5nTGFtYmRhKS5hZGQoJ1dvcmtzaG9wJywgJ0FXUyBDREsgQURPVCBXb3Jrc2hvcCcpO1xuICAgIC8vIEFkZCB0YWdzIHRvIHRoZSBncmVldGluZyBBUEkgR2F0ZXdheVxuICAgIGNkay5UYWdzLm9mKGdyZWV0aW5nQXBpKS5hZGQoJ0Vudmlyb25tZW50JywgZW52aXJvbm1lbnQpO1xuICAgIGNkay5UYWdzLm9mKGdyZWV0aW5nQXBpKS5hZGQoJ1NlcnZpY2VOYW1lJywgc2VydmljZU5hbWUpO1xuICAgIGNkay5UYWdzLm9mKGdyZWV0aW5nQXBpKS5hZGQoJ1Byb2plY3QnLCAnT3RlbEFkb3ROUi1Xb3Jrc2hvcCcpO1xuICAgIGNkay5UYWdzLm9mKGdyZWV0aW5nQXBpKS5hZGQoJ01hbmFnZWRCeScsICdDREsnKTtcbiAgICBjZGsuVGFncy5vZihncmVldGluZ0FwaSkuYWRkKCdXb3Jrc2hvcCcsICdBV1MgQ0RLIEFET1QgV29ya3Nob3AnKTtcbiAgICAvLyBBZGQgdGFncyB0byB0aGUgc3RhY2tcbiAgICBjZGsuVGFncy5vZih0aGlzKS5hZGQoJ0Vudmlyb25tZW50JywgZW52aXJvbm1lbnQpO1xuICAgIGNkay5UYWdzLm9mKHRoaXMpLmFkZCgnU2VydmljZU5hbWUnLCBzZXJ2aWNlTmFtZSk7XG4gICAgY2RrLlRhZ3Mub2YodGhpcykuYWRkKCdQcm9qZWN0JywgJ090ZWxBZG90TlItV29ya3Nob3AnKTtcbiAgICBjZGsuVGFncy5vZih0aGlzKS5hZGQoJ01hbmFnZWRCeScsICdDREsnKTtcbiAgICBjZGsuVGFncy5vZih0aGlzKS5hZGQoJ1dvcmtzaG9wJywgJ0FXUyBDREsgQURPVCBXb3Jrc2hvcCcpO1xuXG4gIH1cbn0iXX0=